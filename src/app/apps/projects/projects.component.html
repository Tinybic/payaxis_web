<div class="row" style="padding-top: 4px;padding-bottom: 16px;">
    <div class="col-md-6">
        <div class="headline-28">{{projectList.length > 0 ? 'Projects' + projectList.length : 'No Projects'}}</div>
        <div class="subtitle-2-500"></div>
    </div>
    <div class="col-md-6 text-end">
        <button class="btn btn-primary btn-text-12" (click)="createProject(0, '')" style="padding: 10px 16px;">
            <i class="fe-file-plus font-16 me-1-1"></i>New Project
        </button>
    </div>
</div>

<div *ngIf="!isLoading && projectList.length > 0">
    <div class="row">
        <div class="col col-3" *ngFor="let project of (projectList | callback: filterPinProjectList); let i=index;">
            <div class="card" style="background-color: {{project.color}}26;">
                <div class="card-body">
                    <div>
                        <span class="badge me-1 text-light btn-text-12"
                              style="padding: 2px 6px;background-color: {{project.color}}26;color: {{project.color}} !important;">{{project.groupName}}</span>
                        <div class="float-end" ngbDropdown placement="bottom-end" style="padding-top: 4px;">
                            <a href="javascript:void(0);" class="arrow-none card-drop" ngbDropdownToggle>
                                <i class="mdi mdi-dots-vertical text-blackprimary"></i>
                            </a>
                            <div ngbDropdownMenu style="padding: 4px 8px;">
                                <a class="subtitle-2-500" href="javascript:void(0);" (click)="openSetColor(project)"
                                   style="padding: 12px 4px;" ngbDropdownItem>
                                    <i class="fe-image me-1-1"></i>
                                    Set color & icon
                                </a>
                                <a class="subtitle-2-500 dropdown-item1" href="javascript:void(0);"
                                   style="padding: 12px 4px;">
                                    <div ngbDropdown placement="end-top">
                                        <div style="width: 100%; color: #202020;" ngbDropdownToggle>
                                            <i class="fe-folder me-1-1"></i>
                                            Move to
                                        </div>
                                        <div *ngIf="companyGroupList.length > 2" ngbDropdownMenu
                                             aria-labelledby="dropdownBasic" class="ms-2-1 mt1-36"
                                             style="padding: 3px 4px;">
                                            <div *ngFor="let group of companyGroupList;">
                                                <a href="javascript:void(0)"
                                                   *ngIf="group.txtName != project.groupName &&  group.txtName != 'All' "
                                                   (click)="projectMoveto(project.id,project.revision,group.id)"
                                                   ngbDropdownItem>{{group.txtName}}
                                                    ({{group.projectcount}})</a>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                                <a class="subtitle-2-500" href="javascript:void(0);" style="padding: 12px 4px;"
                                   ngbDropdownItem>
                                    <i class="fe-plus me-1-1"></i>
                                    Add a new Bill
                                </a>
                                <a *ngIf="project.canDelete" class="subtitle-2-500" href="javascript:void(0);"
                                   style="padding: 12px 4px;color: #EA001E;"
                                   (click)="openProjectDeleteModal(project.id,project.revision,1)" ngbDropdownItem>
                                    <i class="fe-trash-2 me-1-1"></i>
                                    Delete project
                                </a>
                                <a *ngIf="!project.canDelete" class="subtitle-2-500" href="javascript:void(0);"
                                   style="padding: 12px 4px;color: #EA001E;"
                                   (click)="openProjectDeleteModal(project.id,project.revision,0)" ngbDropdownItem>
                                    <i class="fe-archive me-1-1"></i>
                                    Archive project
                                </a>
                            </div>
                        </div>
                        <div class="float-end me-1-1 pe-2" style="padding-top: 2px;">
                            <svg width="14" height="14" viewBox="0 0 14 14"
                                 style="fill: {{project.color}}; cursor: pointer;" (click)="pinProject(project,false)"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                      d="M8.35705 0.433441C8.82518 0.4755 9.26354 0.681088 9.59521 1.01412L12.9452 4.38412C13.1681 4.60367 13.3331 4.87512 13.4252 5.17412C13.5266 5.46956 13.5575 5.78464 13.5152 6.09412C13.4636 6.39841 13.3477 6.68819 13.1752 6.94412C12.997 7.20201 12.7606 7.41439 12.4852 7.56413L11.8292 7.91306L6.06586 2.1497L6.42521 1.47412C6.57209 1.1998 6.78097 0.963539 7.03521 0.784125C7.42093 0.51554 7.88891 0.391383 8.35705 0.433441ZM10.906 8.4041L5.57481 3.07287L3.39556 0.89362C3.10267 0.600727 2.6278 0.600727 2.3349 0.89362C2.04201 1.18651 2.04201 1.66139 2.3349 1.95428L4.83824 4.45762L9.5213 9.14067L12.3349 11.9543C12.6278 12.2472 13.1027 12.2472 13.3956 11.9543C13.6885 11.6614 13.6885 11.1865 13.3956 10.8936L10.906 8.4041ZM8.66971 9.7033L4.26414 5.29773L1.28521 6.47412C1.18495 6.51639 1.09593 6.58145 1.02521 6.66412C0.951965 6.75071 0.90053 6.85358 0.875207 6.96412C0.850499 7.06936 0.850499 7.17889 0.875207 7.28412C0.906357 7.3885 0.961103 7.4843 1.03521 7.56413L3.23521 9.76412L0.395207 12.6241C0.374563 12.7522 0.384624 12.8834 0.424561 13.0069C0.464499 13.1304 0.533173 13.2426 0.624938 13.3344C0.716703 13.4262 0.828938 13.4948 0.952415 13.5348C1.07589 13.5747 1.20708 13.5848 1.33521 13.5641L4.19521 10.7041L6.39521 12.8941C6.47141 12.973 6.56661 13.031 6.67168 13.0625C6.77675 13.0941 6.88815 13.0981 6.99521 13.0741C7.10267 13.0543 7.20283 13.0059 7.28521 12.9341C7.37073 12.8638 7.43913 12.7748 7.48521 12.6741L8.66971 9.7033Z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="d-flex mt-2-1">
                        <div class="me-1-1 flex-shrink-0"
                             style="width: 42px; height: 42px; line-height: 42px; text-align: center; border-radius: 8px; background-color: {{project.color}};">
                            <i class="{{project.icon}} font-26 text-white"></i>
                        </div>
                        <div class="flex-grow-1 overflow-hidden headline-24">
                            {{project.projectName}}
                        </div>
                    </div>
                    <div class="mt-4-1">
                        <div class="d-flex justify-content-between">
                            <div class="Subtitle-1-400">
                                Budget
                                <i class="fe-info text-optional"></i>
                            </div>
                            <div class="float-end Subtitle-1">
                                {{project.projectBudget | currency}}
                            </div>
                        </div>
                        <div class="progress progress-bar-alt-success progress-sm" style="margin-top: 10px;">
                            <div class="progress-bar bg-success wow" role="progressbar" aria-valuenow="20"
                                 aria-valuemin="0" aria-valuemax="100" style="width: 20%; visibility: visible;">
                            </div><!-- /.progress-bar .progress-bar-success -->
                        </div><!-- /.progress .no-rounded -->
                    </div>
                    <div class="d-flex justify-content-between mt-4-1">
                        <div class="avatar-group">
                            <div class="avatar-group-item position-relative" style="z-index: 6;">
                                <img src="assets/images/users/user-6.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 5;">
                                <img src="assets/images/users/user-5.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 4;">
                                <img src="assets/images/users/user-4.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 3;">
                                <img src="assets/images/users/user-2.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 2;">
                                <div class="rounded-circle avatar-sm label-tips"
                                     style="display: inline-flex;vertical-align: middle;justify-content: center;align-items: center;color: white;background-color: #2B2D30">
                                    +4
                                </div>
                            </div>
                        </div>
                        <div class="d-flex align-items-center subtitle-2-500-12 text-optional">
                            Overdue
                            <span class="ms-1 text-center"
                                  style="min-width: 20px;height: 20px;border-radius: 10px;background-color: #F87171;color: white;padding: 4px;">4</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row mt-1-1">
        <div class="col-md-6">
            <div class="d-flex align-items-center">
                <div style="font-size: 20px;font-weight: 600;line-height: 24px;letter-spacing: 0em;text-align: left;">
                    {{getGroupedProjectCount(selectedGroup)}} {{selectedGroup.txtName}} {{selectedGroup.projectcount ==
                1 ? 'Project' : 'Projects'}}
                </div>
                
                
                <div class="filterDropdownMenu d-inline-block dropdown ms-3" ngbDropdown autoClose="outside"
                     #filterDropdownMenu="ngbDropdown">
                    <div class="dropdow-outline c-p search-text" ngbDropdownToggle>
                        <i class="fe-folder me-1-1"></i>
                        {{selectedGroup.txtName}}
                        <i class="fe-chevron-down font-16 ms-1-1"></i>
                    </div>
                    <div id="groupDropdownMenu" class="dropdown-menu" ngbDropdownMenu>
                        <a class="subtitle-2-500 c-p d-flex align-items-center justify-content-between"
                           [ngClass]="{'selected':selectedGroup.id == group.id}"
                           *ngFor="let group of companyGroupList; let i=index;" (click)="filterDropdownMenu.close();selectGroupProject(group);"
                           ngbDropdownItem>
                            <div style="padding: 2px 0px;">
                                <input id="commercialCheck_{{i}}" type="checkbox" class="form-check-input c-p"
                                       [(ngModel)]="group.checked">
                                <label class="form-check-label ms-1-1 c-p" for="commercialCheck_{{i}}">
                                    {{group.txtName}} ({{ getGroupedProjectCount(group)}})
                                </label>
                            </div>
                            <div *ngIf="group.id != 'all' && group.id != '0'" class="groupDotsVertical ms-2-1" ngbDropdown>
                                <button class="btn btn-default float-end" (click)="$event.stopPropagation();selectGroupProject(group);" style="padding: 2px 3px;border-radius: 4px;background-color:#fff;" ngbDropdownToggle>
                                    <i class="fe-more-vertical- text-blackprimary"></i>
                                </button>
                                <div class="dropdown-menu" style="padding: 4px;" ngbDropdownMenu>
                                    <a class="subtitle-2-500 c-p d-flex align-items-center"
                                       (click)="filterDropdownMenu.close();newGroup(group);" ngbDropdownItem>
                                        <i class="fe-type me-1-1"></i>
                                        Rename
                                    </a>
                                    <a class="subtitle-2-500 c-p d-flex align-items-center"
                                       (click)="filterDropdownMenu.close();createProject(0, group)" ngbDropdownItem>
                                        <i class="fe-edit me-1-1"></i>
                                        Add a new Project
                                    </a>
                                    <a class="subtitle-2-500 c-p d-flex align-items-center" style="color: #EA001E;"
                                       (click)="filterDropdownMenu.close();deleteGroup(group, i)" ngbDropdownItem>
                                        <i class="fe-trash-2 me-1-1"></i>
                                        Delete Group
                                    </a>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6 text-end">
            <div class="d-inline-block ms-1-1">
                <input class="form-control form-search" type="search" placeholder="Search here" [(ngModel)]="keywords"
                       style="padding: 10px 16px 10px 36px;"/>
            </div>
            <!-- end search-->
            <button class="btn btn-outline-primary ms-1-1 btn-text-12" (click)="newGroup('all')"
                    style="padding: 7px 16px;"><i class="fe-plus-square me-1-1"
                                                                   style="vertical-align: bottom;"></i>New Group
            </button>
        </div>
    </div>
    <div class="row mt-2-1">
        <div class="col col-3" *ngFor="let project of projectList | callback: filterGroupProjectList; let i=index;">
            <div class="card" style="background-color: #ffffff;">
                <div class="card-body">
                    <div>
                        <span class="badge me-1 text-light btn-text-12"
                              style="padding: 2px 6px;background-color: {{project.color}}26;color: {{project.color}} !important;">{{project.groupName}}</span>
                        <div class="float-end" ngbDropdown placement="bottom-end" style="padding-top: 4px;">
                            <a href="javascript:void(0);" class="arrow-none card-drop" ngbDropdownToggle>
                                <i class="mdi mdi-dots-vertical text-blackprimary"></i>
                            </a>
                            <div ngbDropdownMenu style="padding: 4px 8px;">
                                <a class="subtitle-2-500" href="javascript:void(0);" (click)="openSetColor(project)"
                                   style="padding: 12px 4px;" ngbDropdownItem>
                                    <i class="fe-image me-1-1"></i>
                                    Set color & icon
                                </a>
                                <a class="subtitle-2-500 dropdown-item1" href="javascript:void(0);"
                                   style="padding: 12px 4px;">
                                    <div ngbDropdown placement="end-top">
                                        <div style="width: 100%; color: #202020;" ngbDropdownToggle>
                                            <i class="fe-folder me-1-1"></i>
                                            Move to
                                        </div>
                                        <div *ngIf="companyGroupList.length > 2" ngbDropdownMenu
                                             aria-labelledby="dropdownBasic" class="ms-2-1 mt1-36"
                                             style="padding: 3px 4px;">
                                            <div *ngFor="let group of companyGroupList;">
                                                <a href="javascript:void(0)"
                                                   *ngIf="group.txtName != project.groupName &&  group.txtName != 'All'"
                                                   (click)="projectMoveto(project.id,project.revision,group.id)"
                                                   ngbDropdownItem>{{group.txtName}}
                                                    ({{group.projectcount}})</a>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                                <a class="subtitle-2-500" href="javascript:void(0);" style="padding: 12px 4px;"
                                   ngbDropdownItem>
                                    <i class="fe-plus me-1-1"></i>
                                    Add a new Bill
                                </a>
                                <a *ngIf="project.canDelete" class="subtitle-2-500" href="javascript:void(0);"
                                   style="padding: 12px 4px;color: #EA001E;"
                                   (click)="openProjectDeleteModal(project.id,project.revision,1)" ngbDropdownItem>
                                    <i class="fe-trash-2 me-1-1"></i>
                                    Delete project
                                </a>
                                <a *ngIf="!project.canDelete" class="subtitle-2-500" href="javascript:void(0);"
                                   style="padding: 12px 4px;color: #EA001E;"
                                   (click)="openProjectDeleteModal(project.id,project.revision,0)" ngbDropdownItem>
                                    <i class="fe-archive me-1-1"></i>
                                    Archive project
                                </a>
                            </div>
                        </div>
                        <div class="float-end me-1-1 pe-2" style="padding-top: 2px;">
                            <svg width="16" height="16" viewBox="0 0 16 16" style="fill: #D1D8E2; cursor: pointer;"
                                 (click)="pinProject(project,true)" xmlns="http://www.w3.org/2000/svg">
                                <path
                                        d="M10.73 1.59005C10.3983 1.25702 9.95994 1.05143 9.49181 1.00937C9.02368 0.967311 8.55569 1.09147 8.16997 1.36005C7.91573 1.53947 7.70686 1.77573 7.55997 2.05005L5.55997 5.81005L2.41997 7.05005C2.31972 7.09232 2.2307 7.15737 2.15997 7.24005C2.08673 7.32664 2.0353 7.42951 2.00997 7.54005C1.98526 7.64529 1.98526 7.75482 2.00997 7.86005C2.04112 7.96442 2.09587 8.06023 2.16997 8.14005L4.36997 10.3401L1.52997 13.2001C1.50933 13.3282 1.51939 13.4594 1.55933 13.5828C1.59926 13.7063 1.66794 13.8186 1.7597 13.9103C1.85147 14.0021 1.9637 14.0708 2.08718 14.1107C2.21066 14.1506 2.34185 14.1607 2.46997 14.1401L5.32997 11.2801L7.52997 13.4701C7.60617 13.549 7.70138 13.607 7.80645 13.6385C7.91151 13.67 8.02292 13.674 8.12997 13.6501C8.23743 13.6302 8.33759 13.5819 8.41997 13.5101C8.5055 13.4397 8.57389 13.3508 8.61997 13.2501L9.85997 10.1401L13.62 8.14005C13.8954 7.99032 14.1317 7.77794 14.31 7.52005C14.4825 7.26412 14.5984 6.97434 14.65 6.67005C14.6922 6.36057 14.6614 6.04548 14.56 5.75005C14.4678 5.45105 14.3029 5.1796 14.08 4.96005L10.73 1.59005ZM8.72997 2.68005C8.78062 2.58773 8.85263 2.50887 8.93997 2.45005C9.02408 2.39324 9.11969 2.35568 9.21997 2.34005C9.32179 2.31505 9.42815 2.31505 9.52997 2.34005C9.63023 2.36727 9.7205 2.42282 9.78997 2.50005L13.14 5.85005C13.2138 5.92229 13.2688 6.01158 13.3 6.11005C13.3196 6.20909 13.3196 6.31102 13.3 6.41005C13.2812 6.51419 13.2402 6.61308 13.18 6.70005C13.1205 6.78427 13.0416 6.85288 12.95 6.90005L8.99997 9.08005C8.86771 9.16022 8.76305 9.27883 8.69997 9.42005L7.69997 11.8101L3.79997 7.91005L6.23997 7.00005C6.38661 6.94572 6.5078 6.83878 6.57997 6.70005L8.72997 2.68005Z"/>
                                <path
                                        d="M9.5202 1.81006L7.4002 3.22006L6.5002 5.57006L4.8502 7.07006L2.7002 7.58006L7.1702 12.0801L8.0002 12.6201L9.9902 9.32006L13.9502 6.77006L14.2502 5.80006L9.5202 1.81006Z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="d-flex mt-2-1">
                        <div class="me-1-1 flex-shrink-0"
                             style="width: 42px; height: 42px; line-height: 42px; text-align: center; border-radius: 8px; background-color: {{project.color}}33;">
                            <i class="{{project.icon}} font-26 " style="color: {{project.color}}"></i>
                        </div>
                        <div class="flex-grow-1 overflow-hidden headline-24">
                            {{project.projectName}}
                        </div>
                    </div>
                    <div class="mt-4-1">
                        <div class="d-flex justify-content-between">
                            <div class="Subtitle-1-400">
                                Budget
                                <i class="fe-info text-optional"></i>
                            </div>
                            <div class="float-end Subtitle-1">
                                {{project.projectBudget | currency}}
                            </div>
                        </div>
                        <div class="progress progress-bar-alt-success progress-sm" style="margin-top: 10px;">
                            <div class="progress-bar bg-success wow" role="progressbar" aria-valuenow="20"
                                 aria-valuemin="0" aria-valuemax="100" style="width: 20%; visibility: visible;">
                            </div><!-- /.progress-bar .progress-bar-success -->
                        </div><!-- /.progress .no-rounded -->
                    </div>
                    <div class="d-flex justify-content-between mt-4-1">
                        <div class="avatar-group">
                            <div class="avatar-group-item position-relative" style="z-index: 6;">
                                <img src="assets/images/users/user-6.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 5;">
                                <img src="assets/images/users/user-5.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 4;">
                                <img src="assets/images/users/user-4.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 3;">
                                <img src="assets/images/users/user-2.jpg" class="rounded-circle avatar-sm">
                            </div>
                            <div class="avatar-group-item position-relative" style="z-index: 2;">
                                <div class="rounded-circle avatar-sm label-tips"
                                     style="display: inline-flex;vertical-align: middle;justify-content: center;align-items: center;color: white;background-color: #2B2D30">
                                    +4
                                </div>
                            </div>
                        </div>
                        <div class="d-flex align-items-center subtitle-2-500-12 text-optional">
                            <!--                            {{project.status}}-->
                            Overdue
                            <span class="ms-1 text-center"
                                  style="min-width: 20px;height: 20px;border-radius: 10px;background-color: #F87171;color: white;padding: 4px;">4</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div *ngIf="isLoading" class="position-relative" style="height: calc(100vh - 186px);">
    <app-ui-preloader [display]="isLoading"></app-ui-preloader>
</div>

<div *ngIf="!isLoading && projectList.length == 0" class="container p-v-40">
    <div class="row justify-content-md-center">
        <div class="col-md-4 text-center">
            <img src="assets/images/welcome/noprojects.svg">
            <div class="Subtitle-1 text-optional">
                No Projects...
            </div>
        </div>
    </div>
    <ng-template #joinUsModal let-modal>
        <div class="modal-body" style="padding: 40px 30px;" ngbAutofocus>
            <div class="text-center">
                <img src="assets/images/logo_bg.png">
            </div>
            <div class="headline text-center" style="padding-top: 40px;padding-bottom: 16px;" i18n>Great you join
                us!
            </div>
            <div class="text-1 text-center" i18n>
                We will provide you with the main items of the platform for fast and easy start.
            </div>
            <div class="d-grid" style="margin-top: 40px;">
                <button class="btn btn-primary" (click)="goNext()" i18n>Let's go</button>
            </div>
        </div>
    </ng-template>
</div>

<!--#createProjectModal-->
<ng-template #createProjectModal let-modal>
    <app-create-project [idProject]="idProject" [createProjectWithGroup]="createProjectWithGroup"
                        [modalRef]="modalRef"></app-create-project>
</ng-template>

<!--#newGroupModal-->
<ng-template #newGroupModal let-modal>
    <app-create-group [group]="editGroup" [modalRef]="newGroupModalRef"></app-create-group>
</ng-template>

<!--#selectColor-->
<ng-template #selectColor let-modal>
    <app-set-color [selectColor]="colorSelectItem.color" [selectIcon]="colorSelectItem.icon" [id]="colorSelectItem.id"
                   [revision]="colorSelectItem.revision" [modalRef]="colorRef"></app-set-color>
</ng-template>

<!--#deleteModal-->
<ng-template #deleteModal let-modal>
    <app-delete-modal [title]="deleteObj.title" [message]="deleteObj.message" [btnDelete]="deleteObj.btnDelete" [modalRef]="deleteModalRef" [serviceName]="deleteObj.serviceName" [serviceNameStr]="deleteObj.serviceNameStr" [params]="deleteObj.params"></app-delete-modal>
</ng-template>

<!--#deleteProjectModal-->
<ng-template #deleteProjectModal let-modal>
    <input type="text" style="display: none;"/>
    <div class="delete-modal-container">
        <div class="row">
            <div class="col-md-10">
                <div class="headline-24 text-start">{{projectDeleteText.title}}</div>
            </div>
            <div class="col-md-2 text-end text-black">
                <i class="fe-x cursor-pointer bold-600" (click)="modal.dismiss()"></i>
            </div>
        </div>
        <div class="delete-alert-content text-start">
            {{projectDeleteText.message}}
        </div>
        <div class="d-flex justify-content-between mt-3">
            <div class="delete-cancel-button mt-0 line-40 cursor-pointer" (click)="modal.dismiss()">
                Cancel
            </div>
            <div>
                <button class="btn btn-primary ms-2-1"
                        (click)="projectDelete()">{{projectDeleteText.btnDelete}}</button>
            </div>
        </div>
    </div>
</ng-template>
